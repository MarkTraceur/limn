fieldset.controlGroup
    legend Create a Graph
    form.form-horizontal.span6(data-bind="submit: newGraph, with: blankGraph")
        .control-group
            label.control-label(for="slug") Unique Id
            .controls
                input(type="text", id="slug", placeholder="unique id: must_look_like_this", data-bind="value: slug", required, pattern="^[a-z0-9_]+$")
        .control-group
            label.control-label(for="name") Name
            .controls
                input(type="text", id="name", placeholder="name", data-bind="value: name", required)
        .control-group
            label.control-label(for="desc") Description
            .controls
                textarea(rows=3, cols=50, id="desc", placeholder="description", data-bind="value: desc")
        .control-group
            label.control-label(for="notes") Notes
            .controls
                textarea(rows=3, cols=50, id="notes", placeholder="notes", data-bind="value: notes")
        .control-group
            h4 Metrics in Graph
            .control-group(data-bind="foreach: metrics")
                .controls.controls-row
                    span.span1(data-bind="text: $index")
                    .span3
                        span(data-bind="text: source().name() + ' - ' + label()")
                    .span2
                        a.btn Remove
                        a.btn Keep Only
                        //-
                            (data-bind="click: $parents[1].removeMetricFrom($parent)")
                            (data-bind="click: $parents[1].removeSiblingMetricsFrom($parent)")
        .form-actions
            button.btn Preview
            button.btn.btn-primary.save(type="submit") Save
            span.pull-right(data-bind="text: $parent.message")
    
    
    .span7.pull-right
        h3 Pick Datasources
        .navbar
            .navbar-inner
                .navbar-search
                    input.search-query.datasourceSearch(data-bind="value: filter", placeholder="filter by id or name")

        table.table.table-striped
            thead(data-bind="if: datasources().length == 0"): tr: th Loading all the datasources...
            tbody(data-bind="foreach: filteredDatasources")
                tr
                    td
                        button.btn(data-bind="click: $parent.addDatasource") Add
                    td
                        span(data-bind="text: id")
                    td
                        span(data-bind="text: name")


        .modal.hide.previewDialog(data-backdrop="false", data-bind="if: previewDialog")
            .modal-header
                button.close(data-dismiss="modal", aria-hidden="true") &times;
                h3 Quick Peek
            .modal-body
                section(data-bind="subview: previewDialog")
            .modal-footer
                a.btn.btn-primary(data-dismiss="modal") Close
